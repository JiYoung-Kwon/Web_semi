<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		
<mapper namespace="contact">
	
	<!--  조회   -->
	  <select id='totList' parameterType="mky.Page" resultType="mky.ContactVo">
	  		select * from CONTACT WHERE store like '%${store }%'
			<if test="choice == '제목'">
			and subject LIKE '%${findStr }%'
			</if>
			<if test="choice == '이름'">
			and irum LIKE '%${findStr }%'
			</if>
	  </select>


	   <select id="search" parameterType="mky.Page" resultType="mky.ContactVo">
	   
		  	 SELECT * from(
		   		SELECT rownum rno, m.* from(	
						select * from CONTACT WHERE store like '%${store }%'
							<if test="choice == '제목'">
							and subject LIKE '%${findStr }%'
							</if>
							<if test="choice == '이름'">
							and irum LIKE '%${findStr }%'
							</if>
						) m
		  	) WHERE rno BETWEEN #{startNo} AND #{endNo}
	  		
	   </select>
	   
	   <!-- 입력 -->
	   <select id="contact_getSerial" resultType="Integer">
	   	select seq_contact.nextval from dual
	   </select>
	   
	   <insert id="contact_insert" parameterType="mky.ContactVo">
	   	insert into contact(serial, irum, phone, email, subject, doc, mid, mdate, hit, store)
	   	values(#{serial}, #{irum}, #{phone}, #{email}, #{subject}, #{doc}, #{mid}, sysdate, 0, #{store})
	   </insert>
	   
	   <insert id="contactAtt_insert" parameterType="mky.ContactAttVo">
	   	insert into contactAtt(serial, pserial, oriAtt, sysAtt)
			values(seq_contactAtt.nextval, #{pSerial}, #{oriAtt}, #{sysAtt})
	   </insert>
	   
</mapper>



















